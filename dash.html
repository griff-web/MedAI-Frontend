<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Diagnostic Dashboard | Med-AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<!-- Favicon -->
<link rel="icon" type="image/png" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQdQRHGEmi5WbR1z9s2efKq33kxiId0ir2_dg&s">

<!-- PWA manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">

<!-- Apple PWA Support -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="MedAI">

<!-- Stylesheets -->
<link rel="stylesheet" href="auth.css">
<link rel="stylesheet" href="dash.css">

<!-- Scripts -->
<script src="auth.js" defer></script>
<script src="dash.js" defer></script>

</head>

<body class="dashboard-body">

<nav class="dash-nav">
    <div class="nav-brand">
        <div class="logo">Med<span>AI</span></div>
    </div>

    <div class="user-profile">
        <div class="user-info">
            <span class="user-name" id="display-name">Dr. Loading...</span>
            <span class="user-role">Medical Practitioner</span>
        </div>
        <div class="user-avatar" id="avatar-circle">MD</div>
    </div>
</nav>

<main class="dash-container">

    <aside class="dash-sidebar">
        <button class="nav-item active" data-tab="scanner">
            <i class="icon-camera">üì∏</i>
            <span>Scanner</span>
        </button>

        <button class="nav-item" data-tab="history">
            <i class="icon-history">‚è≥</i>
            <span>History</span>
        </button>

        <button class="nav-item" data-tab="analytics">
            <i class="icon-chart">üìä</i>
            <span>Analytics</span>
        </button>
        
        <div class="sidebar-spacer"></div>

        <button class="nav-item logout-trigger" data-tab="log-out" onclick="location.href='login2.html'">
            <i class="icon-logout">üö™</i>
            <span>Log-out</span>
        </button>
    </aside>

    <section class="main-content">

        <div id="scanner-section" class="content-view">
            <header class="view-header">
                <h2>Live Diagnostic Scan</h2>
                <p>Select scan type and align the medical imagery within the viewfinder.</p>
            </header>

            <div class="scan-type-selector">
                <button class="type-btn active" data-type="xray">X-Ray</button>
                <button class="type-btn" data-type="ct">CT Scan</button>
                <button class="type-btn" data-type="mri">MRI</button>
                <button class="type-btn" data-type="ultrasound">Ultrasound</button>
            </div>

            <div class="scanner-card">
                <div class="camera-container" id="viewfinder">
                    <video id="camera-stream" autoplay playsinline muted></video>

                    <div class="scanner-overlay">
                        <div class="target-box">
                            <div class="corners"></div>
                            <div class="scan-line"></div>
                        </div>
                    </div>

                    <div class="ai-status-badge" id="ai-status-container">
                        <span class="pulse-dot"></span>
                        <span id="ai-status">AI READY</span>
                    </div>
                </div>

                <div class="camera-controls">
                    <button id="capture-trigger" class="btn-capture" title="Capture & Analyze">
                        <div class="inner-circle"></div>
                    </button>
                    <div class="tool-group">
                        <button id="toggle-torch" class="btn-tool" title="Toggle Flash">üî¶</button>
                        <button id="upload-local" class="btn-tool" title="Upload Local File">üìÇ</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="history-section" class="content-view hidden">
            <header class="view-header">
                <h2>Scan History</h2>
                <div class="history-controls">
                    <input type="text" placeholder="Search patient ID..." class="search-input">
                </div>
            </header>
            <div id="history-list" class="data-grid">
                <div class="empty-state">No recent scans found.</div>
            </div>
        </div>

        <div id="analytics-section" class="content-view hidden">
            <header class="view-header">
                <h2>Performance Insights</h2>
                <p>Global AI confidence and diagnostic distribution.</p>
            </header>
            <div class="analytics-placeholder">
                <!-- Charts or graphs go here -->
            </div>
        </div>

    </section>
</main>

<div id="results-panel" class="results-container hidden">
    <div class="panel-blur-overlay"></div>
    <div class="results-content animate-slide-up">
        <div class="panel-header">
            <div class="header-main">
                <span class="ai-badge">MED-AI ANALYSIS</span>
                <h3>Diagnostic Report</h3>
            </div>
            <button id="close-results" aria-label="Close">‚úï</button>
        </div>

        <div class="results-body">
            <div class="analysis-summary">
                <div class="confidence-box">
                    <div class="confidence-score">
                        <svg viewBox="0 0 36 36" class="circular-chart blue">
                            <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            <path class="circle" id="confidence-path" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        </svg>
                        <div class="percentage" id="confidence-text">0%</div>
                    </div>
                    <span class="label">AI Confidence</span>
                </div>

                <div class="diagnosis-label">
                    <h4 id="result-title">Reviewing Imagery...</h4>
                    <p id="result-description">Our neural network is processing the pathological markers in the scan.</p>
                </div>
            </div>

            <div class="clinical-findings">
                <h5><i class="icon-list">üìã</i> Clinical Observations</h5>
                <ul id="findings-list" class="findings-grid">
                    <li class="loading-item">Calibrating sensors...</li>
                </ul>
            </div>

            <div class="action-footer">
                <button class="btn-outline">Print Labels</button>
                <button id="download-pdf" class="btn-primary">Download Medical Report</button>
            </div>
        </div>
    </div>
</div>

<a href="MedBot.html" class="medbot-fab" id="MedBot-btn" title="Ask MedBot Assistant">
    <span class="bot-icon">ü§ñ</span>
    <div class="fab-ping"></div>
</a>

<div id="notification" class="notification-toast hidden"></div>

<!-- PWA Service Worker Registration -->
<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("service-worker.js")
      .then(() => console.log("Service Worker registered"))
      .catch(err => console.error("SW registration failed:", err));
  });
}
</script>

</body>
</html>
